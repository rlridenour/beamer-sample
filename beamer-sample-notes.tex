% Created 2020-06-01 Mon 13:47
% Intended LaTeX compiler: pdflatex
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage{beamerarticle}
\usepackage{amssymb}
\usepackage{url}
\usepackage[normalem]{ulem}
\usepackage{microtype}
\usepackage[american, english]{babel}
\usepackage[letterpaper,centering]{geometry}
\usepackage[sf,sc]{titlesec}
\usepackage[parfill]{parskip} % Line between paragraphs
\usepackage[authordate,url=false,isbn=false,backend=biber]{biblatex-chicago} %Change authordate to notes if desired.
\addbibresource{/Users/rlridenour/zotero.bib}
\clubpenalty = 10000 % Reduce orphans and widows
\widowpenalty = 10000

\usepackage{enumitem}
\setlist[itemize]{noitemsep} % Comment out for wider separation in lists.
\setlist[enumerate]{noitemsep}

\usepackage{libertine}
\usepackage[libertine]{newtxmath}
\usepackage[scaled=0.96]{zi4}
\usepackage[T1]{fontenc}
\usetheme{default}
\author{Randy Ridenour}
\date{June  1, 2020}
\title{Beamer Presentations with Org Mode}
\hypersetup{
 pdfauthor={Randy Ridenour},
 pdftitle={Beamer Presentations with Org Mode},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 26.3 (Org mode 9.4)}, 
 pdflang={English}}
\begin{document}

\maketitle
\maketitle

\begin{frame}[label={sec:org32a16a2},fragile]{Introduction}
 When we moved all courses online for the semester because of the COVID-19 pandemic, I found myself having to make many more presentation slide-decks than I normally do (especially when ``normal'' is none). Keynote produces some beautiful slides, but it requires using the mouse more than I like. I wanted something that I could use to make slides with just a few keystrokes. I settled on exporting an Org mode document to Beamer sides. This is an explanation of the challenges that I had and an example of the solution that I found.


\begin{block}{Advantages of Beamer}
\begin{itemize}
\item Plain text
\item The power of \LaTeX
\item Produces platform-agnostic PDF
\end{itemize}
\end{block}

The Beamer class is a tool used to produce presentations with \LaTeX. It provides the same advantages for presentations that standard \LaTeX provides for other document types, including elegant mathematical formulas, transportability between computing platforms, and the ability focus to on content when writing.


\begin{block}{Disadvantages of Beamer}
\begin{center}
\alert{Writing \LaTeX can be cumbersome!}
\end{center}
\end{block}
\LaTeX is not a simple markup language. After gaining a certain proficiency, it is possible to write it fairly easily. Even so, it is never as simple as using something like Markdown.


\begin{block}{Solution}
\begin{itemize}
\item Emacs Org Mode
\item Problem: producing presentation and article with same content
\item No easy solution found online
\end{itemize}
\end{block}
The solution that I found was Org mode, a very powerful system that includes a simple markup language and the ability to export to \LaTeX. Producing the slide deck was easy, and there were many great examples online. Producing an article was also easy, again with great examples. Producing both a slide presentation and an article, using the same contents file should have been easy, since the official guide to Beamer explains how to do that in \LaTeX. Unfortunately, I couldn't find much guidance on how to do this with Org mode. The only article I could find was this on the official \href{https://orgmode.org/worg/exporters/beamer/beamer-dual-format.html}{Org mode site}. It seemed too complicated, and I was tempted to just go back to directly writing \LaTeX. I decided to try anyway, but I quickly ran into a series of problems:

\begin{enumerate}
\item The Org Beamer export automatically inserted a title slide with \texttt{\textbackslash{}maketitle}. Unfortunately, using the same content for the presentation and notes requires using the \texttt{ignorenonframetext} switch in the document class declaration. Since the export didn't place the command in a frame, there was no title slide.
\item I attempted to fix this by making beginning the contents file with a title-less frame that included the \texttt{\textbackslash{}maketitle} command. That generated a title page, but it came \emph{after} the table of contents slide.
\item The article export did not treat headings correctly, and failed to recognize the Beamer-specific commands.
\end{enumerate}

This was enough to make me want to scrap the project, especially when I looked at the site linked above. The author fixed the title issue by hacking the Beamer export file, something that I certainly didn't want to do. So, as is often the case, after hours of searching for solutions, I began to wonder if the solution could be much simpler than I (or anyone else, it seems) was thinking.
\end{frame}

\begin{frame}[label={sec:org67b5962},fragile]{Details}
 I'll spare any reader the record of attempts, mistakes, other attempts, more mistakes, etc., and just get to the final workflow. I wrote a small script (in my case a function in Fish) that creates three files. One for the presentation, one for the article, and one for shared content. After creating the files, it opens a Dired buffer of the relevant folder in Emacs.\footnote{The function to open a directory in Dired is very small: \texttt{emacsclient -e "(dired \textbackslash{}"\$PWD\textbackslash{}")"}.}

For those who use the Fish shell, here is the function:

\begin{verbatim}
function lecture
    touch {$argv}.org
    echo -e '#+startup: beamer' \n'#+TITLE: ' \n'#+AUTHOR: Dr. Ridenour' \n'#+DATE: ' >>{$argv}.org
    touch {$argv}-beamer.org
    cat /Users/rlridenour/Dropbox/emacs/beamer/lecture-beamer.org >{$argv}-beamer.org
    echo -e '#+include: "'{$argv}'.org" :minlevel 1' >>{$argv}-beamer.org
    touch {$argv}-notes.org
    cat /Users/rlridenour/Dropbox/emacs/beamer/lecture-notes.org >{$argv}-notes.org
    echo -e '#+include: "'{$argv}'.org" :minlevel 1' >>{$argv}-notes.org
    dired
end
\end{verbatim}
So, entering  ``lecture kant'' in the shell will open a Dired buffer containg the files kant.org, kant-beamer.org, and kant-notes.org.

\begin{block}{Contents File}
\begin{itemize}
\item One org file for presentation contents
\item No header information
\item Choose heading level to use as slides
\begin{itemize}
\item I use h3
\end{itemize}
\end{itemize}
\end{block}

The contents file is a standard org file. Initially, I had it containing nothing in the header, except for possibly one line containing \texttt{\#+startup: beamer}, which makes it easier to insert some Beamer-specific commands. After getting tired of entering the same data twice in the other files, I wondered if shared header information could just be placed in the contents file. Occasionally things work exactly how hoped they would, so now the function adds the following lines at the top of the contents file:

\begin{verbatim}
#+startup: beamer
#+TITLE:
#+AUTHOR: Dr. Ridenour
#+DATE:
\end{verbatim}

You will need to decide what heading level will designate a slide. Don't worry, you'll still be able to use that heading level in the article, as I'll explain later. I use h3, so slides begin with a line like this in the contents file:



\texttt{*** Slide Title}

To add notes, you need to structurally separate the note content, which should only be printed on the article, from the preceding slide. To do this, add another h3 heading (I creatively title it ``Notes'') with instructions to ignore the heading:

\begin{verbatim}
 *** Notes :B_ignoreheading:
:PROPERTIES:
:BEAMER_env: ignoreheading
:END:
\end{verbatim}

Any text that follows will only appear in the article, not in the presentation. This does not have to be done for every successive note paragraph, it only needs to be done after a slide. So, any paragraphs that are in the scope of an h1 or h2 heading won't need that.

\begin{block}{Presentation File}
\begin{itemize}
\item Specify slide level: \texttt{\#+OPTIONS: H:3}
\item Add \texttt{ignorenonframetext} to \texttt{\#+LaTeX\_CLASS\_options}
\item Use \texttt{\#+OPTIONS: toc:nil}
\item Begin with two empty slides
\begin{itemize}
\item First with \texttt{\textbackslash{}maketitle}
\item Second with \texttt{\textbackslash{}tableofcontents}
\end{itemize}
\item Add contents file with \texttt{\#+include: "contents.org" :minlevel 1}
\end{itemize}
\end{block}

The magic happens with two small files. The first is the presentation file. At the top, put your preferred Beamer export header, but be sure to include \texttt{\#+LaTeX\_CLASS\_options: [ignorenonframetext]} and \texttt{\#+OPTIONS: toc:nil}. The latter is to ensure that Beamer export doesn't make the contents slide before the presentation title slide.  Then, make the title page like this:

\begin{verbatim}
***
\maketitle
\end{verbatim}


If you want a table of contents slide, you can do the same thing except use \texttt{\textbackslash{}tableofcontents}. Finally, include the contents file with this line: \texttt{\#+include: "contents.org" :minlevel 1}.


\begin{block}{Article File}
\begin{itemize}
\item Use your normal article headers.
\item Add \texttt{\#+LaTeX\_HEADER: \textbackslash{}usepackage\{beamerarticle\}}
\item Add contents file with \texttt{\#+include: "contents.org" :minlevel 1}
\item Be sure to process with Beamer export
\end{itemize}
\end{block}

For the article, use your preferred header with all of the packages declared, but be sure to add this line: \texttt{\#+LaTeX\_HEADER: \textbackslash{}usepackage\{beamerarticle\}}. After the export header lines, include the content file, again using \texttt{\#+include: "contents.org" :minlevel 1}. When exporting, be sure to export with the one of the Beamer exports. Otherwise, things just won't look right.
\end{frame}

\begin{frame}[label={sec:orgacab0f4}]{Conclusion}
\begin{block}{Lessons Learned}
\begin{itemize}
\item Sometimes things don't have to be difficult.
\item One remaining issue: verse environment won't work in beamerarticle.
\item I hope this saves at least one person some time.
\item Any questions or suggestions, please let me know!
\end{itemize}
\end{block}
\end{frame}
\end{document}
